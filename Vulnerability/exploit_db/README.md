# exploit_db/

This directory holds all vulnerability data used by the VTK pipeline — sourced from the official NVD JSON feeds and ExploitDB’s public exploit dataset.

These files are flattened, merged, and indexed into a format suitable for high-speed lookups during the matching process.

---

## Subdirectories

```
exploit_db/
├── exploitdb/      # Raw ExploitDB CSV
├── nvd/            # Raw NVD JSON + flattened CSV
├── index/          # Merged CVE + exploit dataset
└── custom/         # Optional internal exploit records
```

---

## `exploitdb/` — ExploitDB CSV

Contains:
- `files_exploits.csv`: Official dataset of public exploits, including titles, descriptions, CVE references, and source links.

Download the latest version from:  
https://github.com/offensive-security/exploitdb

---

## `nvd/` — National Vulnerability Database

Contains:
- `cve-YYYY.json`: Raw CVE data (downloaded manually or via script)
- `flattened_nvd.csv`: Extracted fields from the JSON using `core/nvd_flattener.py`

You only need to update this if you're syncing with newer CVEs from [nvd.nist.gov](https://nvd.nist.gov/).

---

## `index/` — Merged and Indexed Dataset

This folder contains the combined and optimized dataset used during vulnerability matching.

- `exploitdb_with_nvd.csv`: Merged CVE and exploit descriptions, enriched with NVD metadata.
- `exploit_index.db`: SQLite index of the merged data for fast lookups.

These are generated using:

```bash
python core/nvd_flattener.py
python core/exploitdb_merger.py
python core/exploitdb_indexer.py
```

---

## `custom/` — (Optional) Internal Additions

If you maintain proprietary vulnerabilities, internal exploit signatures, or third-party feeds, drop your custom entries here.

You can format them similarly to `files_exploits.csv` and extend the merger logic in `exploitdb_merger.py` to include them.

---

## Notes

- All output is derived from public CVE and exploit databases
- Matching logic in `vulnerability_matcher.py` is string-based, so CVE references and clean descriptions improve results
- This folder is safe to `.gitignore` for operational deployments

---

## When to Rebuild

Re-run the following scripts any time you update NVD or ExploitDB data:

```bash
python core/nvd_flattener.py
python core/exploitdb_merger.py
python core/exploitdb_indexer.py
```

This will regenerate the full CVE match database used in your analysis pipeline.
