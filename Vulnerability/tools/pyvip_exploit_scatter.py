import pandas as pd
from virtualitics import api

def visualize_matches(auth_token: str, csv_path: str):
    """
    Load exploit match data from CSV and create a 3D scatter plot in Virtualitics Explore.
    
    Args:
        auth_token (str): Your pyVIP API token.
        csv_path (str): Path to the matches.csv file.
    """
    df = pd.read_csv(csv_path)

    vip = api.VIP(auth_token=auth_token)
    vip.load_data(data=df, dataset_name="Exploit Matches")

    vip.scatter(
        x="ip.src",
        y="ip.dst",
        z="cve_id",
        color="exploit_description"
    )

    print("3D Scatter Plot for Exploit Match Results created.")

if __name__ == "__main__":
    token = input("Paste your pyVIP auth token: ").strip()
    path = input("Enter path to matches.csv: ").strip()
    visualize_matches(token, path)