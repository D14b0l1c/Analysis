# core/

Core modules for vulnerability assessment pipeline. Performs data extraction, vulnerability analysis, CVE matching, and risk assessment.

## Modules

### `pcap_extractor.py`
Extracts vulnerability-focused fields from PCAP files with specialized filtering.

- 50+ vulnerability-focused fields (HTTP, DNS, WiFi, SMB, etc.)
- 5 specialized filters: router, web, weak_auth, iot, suspicious
- Automatic vulnerability analysis with risk assessment
- Multi-category reporting

### `xml_extractor.py`  
Nmap XML parsing with vulnerability context and CVE extraction.

- NSE script result parsing for vulnerability detection
- CVE reference extraction from scan results
- Service risk assessment (CRITICAL/HIGH/MEDIUM/LOW)
- Vulnerability categorization and exploit correlation

### `exploitdb_updater.py`
Safe vulnerability database updater - downloads only CVE metadata.

- No exploit code files (prevents Windows Defender flags)
- CVE-focused filtering for vulnerability matching
- Safe vulnerability types (research categories only)
- Metadata-only approach maintains full matching capability

### `vulnerability_matcher.py`
Matching engine for multi-source vulnerability correlation.

- Functions:
  - `match_pcap_to_exploits(...)`
  - `match_nmap_to_exploits(...)`
- Input: Extracted CSV + merged CVE database
- Output: `pcap_matches.csv` or `nmap_matches.csv`

---

### `nvd_flattener.py`
Flattens raw JSON CVE feeds from the NVD into structured CSV.

- Input: `cve-*.json` (e.g., `cve-2025.json`)
- Output: `flattened_nvd.csv`
- Optional: run when updating NVD data

---

### `exploitdb_merger.py`
Merges flattened NVD data with ExploitDB records based on CVE ID.

- Input: `flattened_nvd.csv` and `files_exploits.csv`
- Output: `exploitdb_with_nvd.csv`

---

### `exploitdb_indexer.py`
Creates a fast SQLite index of the merged vulnerability dataset.

- Input: `exploitdb_with_nvd.csv`
- Output: `exploit_index.db`
- Enables fast filtering and extensibility for future tools

---

## How These Work Together

You typically don’t run these scripts individually — they’re invoked automatically by `main.py`. However, you *can* run them in sequence to:

1. Update CVE and exploit data:
   ```bash
   python nvd_flattener.py
   python exploitdb_merger.py
   python exploitdb_indexer.py
   ```

2. Test a manual extraction/match step:
   ```bash
   python pcap_extractor.py
   python vulnerability_matcher.py
   ```

---

## Notes

- All modules are written in pure Python 3 (3.8+)
- Uses standard libraries + `pandas`
- PCAP support requires `tshark` to be installed
- Designed for easy reuse in other systems or CLI wrappers
