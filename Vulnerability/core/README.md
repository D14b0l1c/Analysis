# core/

This directory contains the core logic that powers the VTK (Vulnerability Traffic Knowledge Engine) pipeline. These Python modules perform all data extraction, transformation, matching, and vulnerability enrichment.

They are typically orchestrated via `main.py`, but you can run many of them standalone for testing or advanced workflows.

---

## Modules Overview

### `pcap_extractor.py`
Extracts rich protocol and metadata fields from `.pcap` files using `tshark`.

- Fields: IP/MAC, DNS queries, HTTP headers, Wi-Fi frames, GPS (if available)
- Output: `data/output/pcap_extracted_output.csv`
- Used in: PCAP analysis pipeline

---

### `xml_extractor.py`
Parses `.xml` output from Nmap scans and extracts services, ports, products, versions, and CPEs.

- Output: `data/output/nmap_extracted_output.csv`
- Used in: Nmap XML analysis pipeline

---

### `vulnerability_matcher.py`
Matches either extracted PCAP data or Nmap service data to known CVEs using keyword and string similarity logic.

- Functions:
  - `match_pcap_to_exploits(...)`
  - `match_nmap_to_exploits(...)`
- Input: Extracted CSV + merged CVE database
- Output: `pcap_matches.csv` or `nmap_matches.csv`

---

### `nvd_flattener.py`
Flattens raw JSON CVE feeds from the NVD into structured CSV.

- Input: `cve-*.json` (e.g., `cve-2025.json`)
- Output: `flattened_nvd.csv`
- Optional: run when updating NVD data

---

### `exploitdb_merger.py`
Merges flattened NVD data with ExploitDB records based on CVE ID.

- Input: `flattened_nvd.csv` and `files_exploits.csv`
- Output: `exploitdb_with_nvd.csv`

---

### `exploitdb_indexer.py`
Creates a fast SQLite index of the merged vulnerability dataset.

- Input: `exploitdb_with_nvd.csv`
- Output: `exploit_index.db`
- Enables fast filtering and extensibility for future tools

---

## How These Work Together

You typically don’t run these scripts individually — they’re invoked automatically by `main.py`. However, you *can* run them in sequence to:

1. Update CVE and exploit data:
   ```bash
   python nvd_flattener.py
   python exploitdb_merger.py
   python exploitdb_indexer.py
   ```

2. Test a manual extraction/match step:
   ```bash
   python pcap_extractor.py
   python vulnerability_matcher.py
   ```

---

## Notes

- All modules are written in pure Python 3 (3.8+)
- Uses standard libraries + `pandas`
- PCAP support requires `tshark` to be installed
- Designed for easy reuse in other systems or CLI wrappers
