# Vulnerability Module

This module is a standalone, plug-and-play system designed to analyze PCAP files or Nmap XML scan output and identify potential vulnerabilities. It matches observed traffic or discovered services against known exploits from ExploitDB and the NVD (National Vulnerability Database), then optionally visualizes the findings in 3D via Virtualitics Explore.

---

## What It Does

1. **Extracts structured data from PCAPs** using `tshark` or from Nmap XML scans
2. **Matches indicators** (hostnames, user agents, ports, services, CPEs) to:
   - A merged CVE dataset from ExploitDB and NVD
   - An indexed SQLite database for fast lookups
3. **Outputs structured CSVs** of matches with MAC/IPs, matched terms, CVEs, and exploit descriptions
4. **Visualizes matches in Virtualitics Explore** using pyVIP

---

## Directory Structure

| Path                      | Purpose |
|---------------------------|---------|
| `main.py`                | Entry point: processes PCAP or XML input |
| `core/`                  | Python modules for extraction, matching, and DB handling |
| `data/input/`            | Drop `.pcap` and `.xml` files here |
| `data/output/`           | Outputs from extraction and matching |
| `data/db/`               | Flattened NVD, merged exploit CSVs, etc. |
| `exploit_db/`            | Source CVE and exploit data from ExploitDB and NVD |
| `tools/`                 | Optional scripts like pyVIP visualization |
| `docs/`                  | Setup guide and internal documentation |

---

## Quick Start

1. Drop your `.pcap` or `.xml` file in `data/input/`
2. Run the pipeline:

```bash
python main.py
```

3. You'll be prompted to enter the input file path (or press Enter for the default)

4. Results will be saved to:

- `data/output/pcap_matches.csv` — for PCAP inputs  
- `data/output/nmap_matches.csv` — for Nmap XML inputs

---

## Visualize in 3D (Optional)

To launch a 3D scatter plot in Virtualitics Explore:

```bash
python tools/pyvip_exploit_scatter.py
```

You’ll be prompted for:

- Your pyVIP API token
- The path to the match results CSV

Explore matches by IP, CVE ID, and exploit metadata.

---

## Requirements

- Python 3.8+
- `tshark` must be installed and available in your PATH
- Install dependencies via:

```bash
pip install -r requirements.txt
```

---

## Update Vulnerability Database

To regenerate the merged exploit dataset:

```bash
python core/nvd_flattener.py
python core/exploitdb_merger.py
python core/exploitdb_indexer.py
```

---

## Extend It

- Add your own proprietary indicators under:
  ```
  exploit_db/custom/
  ```
- Modify the matching logic in `core/vulnerability_matcher.py` as needed.

---

## Ideal For

- Packet forensics (live or post-incident)
- Air-gapped network defense
- Embedded threat intel into analyst workflows
- Integration with 3D visual analytics
